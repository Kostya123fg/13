<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí° –°—Ç–∞–≤–∫–∏ –æ—Ç AI</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --accent-color: #10b981;
            --accent-dark: #059669;
            --accent-light: #34d399;
            --accent-color-rgb: 16, 185, 129;
        }
        
        body.theme-ufc {
            --accent-color: #ef4444;
            --accent-dark: #dc2626;
            --accent-light: #f87171;
            --accent-color-rgb: 239, 68, 68;
        }
        
        body.theme-cs2 {
            --accent-color: #f59e0b;
            --accent-dark: #d97706;
            --accent-light: #fbbf24;
            --accent-color-rgb: 245, 158, 11;
        }
        
        body.theme-dota {
            --accent-color: #a855f7;
            --accent-dark: #9333ea;
            --accent-light: #c084fc;
            --accent-color-rgb: 168, 85, 247;
        }
        
        body.theme-hockey {
            --accent-color: #06b6d4;
            --accent-dark: #0891b2;
            --accent-light: #22d3ee;
            --accent-color-rgb: 6, 182, 212;
        }
        
        body.theme-boxing {
            --accent-color: #dc2626;
            --accent-dark: #b91c1c;
            --accent-light: #f87171;
            --accent-color-rgb: 220, 38, 38;
        }
        
        body.theme-basketball {
            --accent-color: #f97316;
            --accent-dark: #ea580c;
            --accent-light: #fb923c;
            --accent-color-rgb: 249, 115, 22;
        }
        
        body {
            background: linear-gradient(180deg, #1a1f2e 0%, #161b28 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(51, 65, 85, 0.5);
            border-radius: 12px;
        }
        .upload-container {
            background: #232d3f;
            border: 2px dashed rgba(100, 116, 139, 0.4);
            border-radius: 12px;
            transition: all 0.3s ease, border-color 0.5s ease;
        }
        .upload-container:hover {
            border-color: rgba(var(--accent-color-rgb), 0.5);
        }
        .upload-container.dragover {
            background: rgba(var(--accent-color-rgb), 0.1);
            border-color: var(--accent-color);
        }
        .preview-image {
            width: 100%;
            max-height: 180px;
            object-fit: contain;
            border-radius: 8px;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-dark) 100%);
            box-shadow: 0 4px 16px rgba(var(--accent-color-rgb), 0.3);
            border: none;
            color: white;
            font-weight: 600;
            font-size: 15px;
            padding: 14px;
            border-radius: 8px;
            width: 100%;
            cursor: pointer;
            transition: all 0.5s ease;
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(var(--accent-color-rgb), 0.4);
        }
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .spinner {
            border: 2px solid rgba(255,255,255,0.2);
            border-top: 2px solid white;
            border-radius: 50%;
            width: 14px;
            height: 14px;
            animation: spin 0.8s linear infinite;
            display: inline-block;
            margin-left: 6px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .progress-bar {
            height: 6px;
            background: rgba(var(--accent-color-rgb), 0.2);
            border-radius: 3px;
            overflow: hidden;
            transition: background 0.5s ease;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color) 0%, var(--accent-light) 100%);
            border-radius: 3px;
            transition: width 0.6s ease, background 0.5s ease;
        }
        .stat-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        .confidence-high {
            background: rgba(var(--accent-color-rgb), 0.2);
            color: var(--accent-color);
            transition: all 0.5s ease;
        }
        #analyticsText strong {
            color: #fff;
            font-weight: 600;
        }
        #analyticsText br {
            margin-bottom: 4px;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="max-w-md mx-auto px-4 py-4">
        <!-- Header -->
        <div class="flex items-center justify-between mb-5">
            <div class="flex items-center gap-2">
                <span class="text-xl">üí°</span>
                <h1 class="text-emerald-400 text-lg font-bold">–°—Ç–∞–≤–∫–∏ –æ—Ç AI</h1>
            </div>
            <div id="langSelector" class="flex items-center gap-2 px-3 py-1 rounded-full cursor-pointer hover:bg-opacity-80 transition" style="background: rgba(30, 41, 59, 0.8);">
                <span id="currentFlag" style="font-size: 14px;">üá∑üá∫</span>
                <span id="currentLangName" class="text-gray-300 text-xs font-medium">RU</span>
            </div>
        </div>

        <!-- Language Modal -->
        <div id="langModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50" style="backdrop-filter: blur(5px);">
            <div class="card p-6 max-w-sm w-full mx-4">
                <h2 class="text-white text-lg font-bold mb-4 text-center">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / Choose language</h2>
                <div id="langList" class="space-y-2 max-h-96 overflow-y-auto">
                    <!-- Languages will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Category -->
        <div class="mb-4">
            <select id="categorySelect" class="category-select bg-slate-800 text-gray-300 text-sm px-3 py-2 rounded-lg border border-slate-700 focus:outline-none cursor-pointer transition-colors" style="border-color: var(--accent-color);">
                <option value="football">‚öΩ –§—É—Ç–±–æ–ª</option>
                <option value="ufc">ü•ä UFC</option>
                <option value="cs2">üéÆ CS 2</option>
                <option value="dota">‚öîÔ∏è Dota 2</option>
                <option value="hockey">üèí –•–æ–∫–∫–µ–π</option>
                <option value="boxing">ü•ä –ë–æ–∫—Å</option>
                <option value="basketball">üèÄ –ë–∞—Å–∫–µ—Ç–±–æ–ª</option>
            </select>
        </div>

        <!-- Upload Container -->
        <div id="uploadArea" class="upload-container p-6 mb-4 cursor-pointer">
            <input type="file" id="fileInput" accept="image/*" class="hidden">
            
            <!-- Upload Prompt -->
            <div id="uploadPrompt" class="text-center">
                <svg class="mx-auto h-10 w-10 text-gray-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <p class="text-white text-sm mb-1">üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</p>
                <p class="text-gray-500 text-xs">–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç (Ctrl + V)</p>
            </div>

            <!-- Image Preview -->
            <div id="imagePreview" class="hidden text-center">
                <img id="previewImg" class="preview-image mb-3">
                <button id="changeImageBtn" class="text-emerald-400 text-xs hover:text-emerald-300">
                    üì§ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                </button>
            </div>
        </div>

        <!-- Analyze Button -->
        <button id="analyzeBtn" class="btn-primary hidden">
            <span id="btnText">üîç –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–≤–∫—É</span>
            <span id="btnSpinner" class="spinner hidden"></span>
        </button>

        <!-- Attempts Counter (always visible) -->
        <div id="attemptsInfo" class="text-center text-gray-400 text-xs mt-3 mb-4 hidden">
            <span id="attemptsLabelMain">–ü–æ–ø—ã—Ç–æ–∫ —Å–µ–≥–æ–¥–Ω—è:</span> <span id="attemptsCounterMain" class="text-emerald-400 font-semibold">10 –∏–∑ 10</span>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <!-- Confidence & Signal -->
            <div class="grid grid-cols-2 gap-3 mb-4">
                <!-- Confidence -->
                <div class="card p-4">
                    <div class="text-gray-400 text-xs mb-1">–£–í–ï–†–ï–ù–ù–û–°–¢–¨ AI</div>
                    <div id="confidenceValue" class="text-white text-2xl font-bold">70%</div>
                </div>
                <!-- Signal -->
                <div class="card p-4">
                    <div class="text-gray-400 text-xs mb-1">–ù–ê–î–ï–ñ–ù–´–ô –°–ò–ì–ù–ê–õ</div>
                    <div id="signalValue" class="text-white text-sm font-semibold leading-tight"></div>
                </div>
            </div>

            <!-- Events Stats -->
            <div class="card p-4 mb-4">
                <div class="text-gray-400 text-xs mb-3">% –°–û–ë–´–¢–ò–ô</div>
                <div id="eventStats" class="space-y-3">
                    <!-- Dynamic stats will be inserted here -->
                </div>
            </div>

            <!-- AI Analytics -->
            <div class="card p-4 mb-4">
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-lg">ü§ñ</span>
                    <h3 class="text-white font-bold text-sm">AI –ê–ù–ê–õ–ò–¢–ò–ö–ê</h3>
                </div>
                <div id="analyticsText" class="text-gray-300 text-xs leading-relaxed"></div>
            </div>

            <!-- Footer -->
            <div class="text-center text-gray-500 text-xs py-4">
                <span id="attemptsLabel">–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</span> <span id="attemptsCounter" class="text-white font-semibold">10 –∏–∑ 10</span>
            </div>
        </div>

        <!-- Error Area -->
        <div id="errorArea" class="hidden mt-4">
            <div class="card p-4 border-red-900">
                <p id="errorText" class="text-red-400 text-sm text-center"></p>
            </div>
        </div>
    </div>

    <script>
        // ========== –ú–£–õ–¨–¢–ò–Ø–ó–´–ß–ù–û–°–¢–¨ ==========
        const translations = {
            ru: {
                title: '–°—Ç–∞–≤–∫–∏ –æ—Ç AI',
                categoryFootball: '‚öΩ –§—É—Ç–±–æ–ª',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí –•–æ–∫–∫–µ–π',
                categoryBoxing: 'ü•ä –ë–æ–∫—Å',
                categoryBasketball: 'üèÄ –ë–∞—Å–∫–µ—Ç–±–æ–ª',
                uploadTitle: 'üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è',
                uploadSubtitle: '–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç (Ctrl + V)',
                changeImage: 'üì§ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
                analyzeBtn: 'üîç –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–≤–∫—É',
                analyzing: '–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º...',
                confidence: '–£–í–ï–†–ï–ù–ù–û–°–¢–¨ AI',
                signal: '–ù–ê–î–ï–ñ–ù–´–ô –°–ò–ì–ù–ê–õ',
                events: '% –°–û–ë–´–¢–ò–ô',
                analytics: 'AI –ê–ù–ê–õ–ò–¢–ò–ö–ê',
                attemptsToday: '–ü–æ–ø—ã—Ç–æ–∫ —Å–µ–≥–æ–¥–Ω—è:',
                attemptsLeft: '–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:',
                unlimited: '–ë–µ–∑–ª–∏–º–∏—Ç',
                errorSize: '–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 10MB',
                errorImage: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'
            },
            en: {
                title: 'AI Betting',
                categoryFootball: '‚öΩ Football',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí Hockey',
                categoryBoxing: 'ü•ä Boxing',
                categoryBasketball: 'üèÄ Basketball',
                uploadTitle: 'üì∏ Upload event image',
                uploadSubtitle: 'Or just paste a screenshot (Ctrl + V)',
                changeImage: 'üì§ Try another image',
                analyzeBtn: 'üîç Analyze bet',
                analyzing: 'Analyzing...',
                confidence: 'AI CONFIDENCE',
                signal: 'RELIABLE SIGNAL',
                events: '% EVENTS',
                analytics: 'AI ANALYTICS',
                attemptsToday: 'Attempts today:',
                attemptsLeft: 'Attempts left today:',
                unlimited: 'Unlimited',
                errorSize: 'File size must not exceed 10MB',
                errorImage: 'Please select an image'
            },
            hi: {
                title: 'AI ‡§∏‡•á ‡§¶‡§æ‡§Ç‡§µ',
                categoryFootball: '‚öΩ ‡§´‡•Å‡§ü‡§¨‡•â‡§≤',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí ‡§π‡•â‡§ï‡•Ä',
                categoryBoxing: 'ü•ä ‡§Æ‡•Å‡§ï‡•ç‡§ï‡•á‡§¨‡§æ‡§ú‡•Ä',
                categoryBasketball: 'üèÄ ‡§¨‡§æ‡§∏‡•ç‡§ï‡•á‡§ü‡§¨‡•â‡§≤',
                uploadTitle: 'üì∏ ‡§á‡§µ‡•á‡§Ç‡§ü ‡§õ‡§µ‡§ø ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç',
                uploadSubtitle: '‡§Ø‡§æ ‡§¨‡§∏ ‡§è‡§ï ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®‡§∂‡•â‡§ü ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (Ctrl + V)',
                changeImage: 'üì§ ‡§¶‡•Ç‡§∏‡§∞‡•Ä ‡§õ‡§µ‡§ø ‡§Ü‡§ú‡§º‡§Æ‡§æ‡§è‡§Ç',
                analyzeBtn: 'üîç ‡§¶‡§æ‡§Ç‡§µ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç',
                analyzing: '‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',
                confidence: 'AI ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏',
                signal: '‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§∏‡§Ç‡§ï‡•á‡§§',
                events: '% ‡§ò‡§ü‡§®‡§æ‡§è‡§Ç',
                analytics: 'AI ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£',
                attemptsToday: '‡§Ü‡§ú ‡§ï‡•á ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏:',
                attemptsLeft: '‡§Ü‡§ú ‡§∂‡•á‡§∑ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏:',
                unlimited: '‡§Ö‡§∏‡•Ä‡§Æ‡§ø‡§§',
                errorSize: '‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ 10MB ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è',
                errorImage: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§õ‡§µ‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç'
            },
            es: {
                title: 'Apuestas IA',
                categoryFootball: '‚öΩ F√∫tbol',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí Hockey',
                categoryBoxing: 'ü•ä Boxeo',
                categoryBasketball: 'üèÄ Baloncesto',
                uploadTitle: 'üì∏ Subir imagen del evento',
                uploadSubtitle: 'O simplemente pega una captura (Ctrl + V)',
                changeImage: 'üì§ Probar otra imagen',
                analyzeBtn: 'üîç Analizar apuesta',
                analyzing: 'Analizando...',
                confidence: 'CONFIANZA IA',
                signal: 'SE√ëAL CONFIABLE',
                events: '% EVENTOS',
                analytics: 'AN√ÅLISIS IA',
                attemptsToday: 'Intentos hoy:',
                attemptsLeft: 'Intentos restantes hoy:',
                unlimited: 'Ilimitado',
                errorSize: 'El tama√±o del archivo no debe superar los 10MB',
                errorImage: 'Por favor selecciona una imagen'
            },
            az: {
                title: 'AI M…ôrcl…ôri',
                categoryFootball: '‚öΩ Futbol',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí Xokkey',
                categoryBoxing: 'ü•ä Boks',
                categoryBasketball: 'üèÄ Basketbol',
                uploadTitle: 'üì∏ T…ôdbir ≈ü…ôklini y√ºkl…ôyin',
                uploadSubtitle: 'V…ô ya sad…ôc…ô ekran g√∂r√ºnt√ºs√º yapƒ±≈üdƒ±rƒ±n (Ctrl + V)',
                changeImage: 'üì§ Ba≈üqa ≈ü…ôkil sƒ±nayƒ±n',
                analyzeBtn: 'üîç M…ôrci t…ôhlil edin',
                analyzing: 'T…ôhlil edilir...',
                confidence: 'AI ∆èMINLIK',
                signal: 'ETƒ∞BARLI Sƒ∞QNAL',
                events: '% HADƒ∞S∆èL∆èR',
                analytics: 'AI T∆èHLƒ∞L',
                attemptsToday: 'Bu g√ºn c…ôhdl…ôr:',
                attemptsLeft: 'Bu g√ºn qalan c…ôhdl…ôr:',
                unlimited: 'Limitsiz',
                errorSize: 'Fayl √∂l√ß√ºs√º 10MB-dan √ßox olmamalƒ±dƒ±r',
                errorImage: 'Z…ôhm…ôt olmasa ≈ü…ôkil se√ßin'
            },
            pt: {
                title: 'Apostas IA',
                categoryFootball: '‚öΩ Futebol',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí H√≥quei',
                categoryBoxing: 'ü•ä Boxe',
                categoryBasketball: 'üèÄ Basquete',
                uploadTitle: 'üì∏ Carregar imagem do evento',
                uploadSubtitle: 'Ou apenas cole uma captura (Ctrl + V)',
                changeImage: 'üì§ Tentar outra imagem',
                analyzeBtn: 'üîç Analisar aposta',
                analyzing: 'Analisando...',
                confidence: 'CONFIAN√áA IA',
                signal: 'SINAL CONFI√ÅVEL',
                events: '% EVENTOS',
                analytics: 'AN√ÅLISE IA',
                attemptsToday: 'Tentativas hoje:',
                attemptsLeft: 'Tentativas restantes hoje:',
                unlimited: 'Ilimitado',
                errorSize: 'O tamanho do arquivo n√£o deve exceder 10MB',
                errorImage: 'Por favor, selecione uma imagem'
            },
            tr: {
                title: 'AI Bahisleri',
                categoryFootball: '‚öΩ Futbol',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí Hokey',
                categoryBoxing: 'ü•ä Boks',
                categoryBasketball: 'üèÄ Basketbol',
                uploadTitle: 'üì∏ Etkinlik g√∂rselini y√ºkleyin',
                uploadSubtitle: 'Veya sadece ekran g√∂r√ºnt√ºs√º yapƒ±≈ütƒ±rƒ±n (Ctrl + V)',
                changeImage: 'üì§ Ba≈üka resim deneyin',
                analyzeBtn: 'üîç Bahsi analiz et',
                analyzing: 'Analiz ediliyor...',
                confidence: 'AI G√úVENƒ∞',
                signal: 'G√úVENƒ∞Lƒ∞R Sƒ∞NYAL',
                events: '% OLAYLAR',
                analytics: 'AI ANALƒ∞Z',
                attemptsToday: 'Bug√ºn denemeler:',
                attemptsLeft: 'Bug√ºn kalan denemeler:',
                unlimited: 'Sƒ±nƒ±rsƒ±z',
                errorSize: 'Dosya boyutu 10MB\'ƒ± ge√ßmemelidir',
                errorImage: 'L√ºtfen bir resim se√ßin'
            },
            ar: {
                title: 'ÿ±ŸáÿßŸÜÿßÿ™ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä',
                categoryFootball: '‚öΩ ŸÉÿ±ÿ© ÿßŸÑŸÇÿØŸÖ',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí ŸáŸàŸÉŸä',
                categoryBoxing: 'ü•ä ŸÖŸÑÿßŸÉŸÖÿ©',
                categoryBasketball: 'üèÄ ŸÉÿ±ÿ© ÿßŸÑÿ≥ŸÑÿ©',
                uploadTitle: 'üì∏ ÿ™ÿ≠ŸÖŸäŸÑ ÿµŸàÿ±ÿ© ÿßŸÑÿ≠ÿØÿ´',
                uploadSubtitle: 'ÿ£Ÿà ŸÇŸÖ ÿ®ŸÑÿµŸÇ ŸÑŸÇÿ∑ÿ© ÿ¥ÿßÿ¥ÿ© (Ctrl + V)',
                changeImage: 'üì§ ÿ¨ÿ±ÿ® ÿµŸàÿ±ÿ© ÿ£ÿÆÿ±Ÿâ',
                analyzeBtn: 'üîç ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ±ŸáÿßŸÜ',
                analyzing: 'ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ...',
                confidence: 'ÿ´ŸÇÿ© ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä',
                signal: 'ÿ•ÿ¥ÿßÿ±ÿ© ŸÖŸàÿ´ŸàŸÇÿ©',
                events: '% ÿßŸÑÿ£ÿ≠ÿØÿßÿ´',
                analytics: 'ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä',
                attemptsToday: 'ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™ ÿßŸÑŸäŸàŸÖ:',
                attemptsLeft: 'ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™ ÿßŸÑŸÖÿ™ÿ®ŸÇŸäÿ© ÿßŸÑŸäŸàŸÖ:',
                unlimited: 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØŸàÿØ',
                errorSize: 'Ÿäÿ¨ÿ® ÿ£ŸÑÿß Ÿäÿ™ÿ¨ÿßŸàÿ≤ ÿ≠ÿ¨ŸÖ ÿßŸÑŸÖŸÑŸÅ 10 ŸÖŸäÿ¨ÿßÿ®ÿßŸäÿ™',
                errorImage: 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ™ÿ≠ÿØŸäÿØ ÿµŸàÿ±ÿ©'
            },
            uz: {
                title: 'AI Tikish',
                categoryFootball: '‚öΩ Futbol',
                categoryUFC: 'ü•ä UFC',
                categoryCS2: 'üéÆ CS 2',
                categoryDota: '‚öîÔ∏è Dota 2',
                categoryHockey: 'üèí Xokkey',
                categoryBoxing: 'ü•ä Boks',
                categoryBasketball: 'üèÄ Basketbol',
                uploadTitle: 'üì∏ Tadbir rasmini yuklang',
                uploadSubtitle: 'Yoki shunchaki ekran tasvirini joylashtiring (Ctrl + V)',
                changeImage: 'üì§ Boshqa rasmni sinab ko\'ring',
                analyzeBtn: 'üîç Tikishni tahlil qiling',
                analyzing: 'Tahlil qilinmoqda...',
                confidence: 'AI ISHONCH',
                signal: 'ISHONCHLI SIGNAL',
                events: '% HODISALAR',
                analytics: 'AI TAHLIL',
                attemptsToday: 'Bugun urinishlar:',
                attemptsLeft: 'Bugun qolgan urinishlar:',
                unlimited: 'Cheksiz',
                errorSize: 'Fayl hajmi 10MB dan oshmasligi kerak',
                errorImage: 'Iltimos, rasm tanlang'
            }
        };

        // –ë—Ä–∞–∑–∏–ª—å—Å–∫–∏–π –ø–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π (–∫–æ–ø–∏—è pt)
        translations.br = { ...translations.pt };

        // –Ø–∑—ã–∫–æ–≤—ã–µ —Ñ–ª–∞–≥–∏ –∏ –∫–æ–¥—ã
        const languages = [
            { code: 'ru', flag: 'üá∑üá∫', name: 'RU' },
            { code: 'en', flag: 'üá¨üáß', name: 'EN' },
            { code: 'hi', flag: 'üáÆüá≥', name: 'HI' },
            { code: 'es', flag: 'üá™üá∏', name: 'ES' },
            { code: 'az', flag: 'üá¶üáø', name: 'AZ' },
            { code: 'pt', flag: 'üáµüáπ', name: 'PT' },
            { code: 'br', flag: 'üáßüá∑', name: 'BR' },
            { code: 'tr', flag: 'üáπüá∑', name: 'TR' },
            { code: 'ar', flag: 'üá∏üá¶', name: 'AR' },
            { code: 'uz', flag: 'üá∫üáø', name: 'UZ' }
        ];

        // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä—É—Å—Å–∫–∏–π)
        let currentLang = localStorage.getItem('language') || 'ru';

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤
        function updateTexts() {
            const t = translations[currentLang];
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
            const h1 = document.querySelector('h1');
            if (h1) h1.textContent = t.title;
            
            const categorySelect = document.getElementById('categorySelect');
            if (categorySelect) {
                categorySelect.options[0].text = t.categoryFootball;
                categorySelect.options[1].text = t.categoryUFC;
                categorySelect.options[2].text = t.categoryCS2;
                categorySelect.options[3].text = t.categoryDota;
                categorySelect.options[4].text = t.categoryHockey;
                categorySelect.options[5].text = t.categoryBoxing;
                categorySelect.options[6].text = t.categoryBasketball;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const uploadPrompt = document.getElementById('uploadPrompt');
            if (uploadPrompt) {
                const uploadTexts = uploadPrompt.querySelectorAll('p');
                if (uploadTexts[0]) uploadTexts[0].textContent = t.uploadTitle;
                if (uploadTexts[1]) uploadTexts[1].textContent = t.uploadSubtitle;
            }
            
            const changeImageBtn = document.getElementById('changeImageBtn');
            if (changeImageBtn) changeImageBtn.textContent = t.changeImage;
            
            const btnTextEl = document.getElementById('btnText');
            const analyzeBtnEl = document.getElementById('analyzeBtn');
            if (btnTextEl && (!analyzeBtnEl || !analyzeBtnEl.disabled)) btnTextEl.textContent = t.analyzeBtn;
            
            // –°—á–µ—Ç—á–∏–∫–∏ –ø–æ–ø—ã—Ç–æ–∫
            const attemptsLabelMain = document.getElementById('attemptsLabelMain');
            if (attemptsLabelMain) attemptsLabelMain.textContent = t.attemptsToday;
            
            const attemptsLabel = document.getElementById('attemptsLabel');
            if (attemptsLabel) attemptsLabel.textContent = t.attemptsLeft;
            
            // –°–µ–∫—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            const confidenceLabels = document.querySelectorAll('.text-gray-400.text-xs.mb-1');
            if (confidenceLabels[0]) confidenceLabels[0].textContent = t.confidence;
            if (confidenceLabels[1]) confidenceLabels[1].textContent = t.signal;
            
            const eventsLabel = document.querySelectorAll('.text-gray-400.text-xs.mb-3')[0];
            if (eventsLabel) eventsLabel.textContent = t.events;
            
            const analyticsTitle = document.querySelector('h3.text-white');
            if (analyticsTitle) analyticsTitle.textContent = t.analytics;
        }

        // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø API ==========
        // –î–ª—è webapp –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –∫ —Ç–µ–∫—É—â–µ–º—É —Å–µ—Ä–≤–µ—Ä—É
      const urlParams = new URLSearchParams(window.location.search);
      const serverFromUrl = urlParams.get('server');

      let API_BASE = serverFromUrl || 'http://localhost:5000';

console.log('üîó API_BASE:', API_BASE);

        // ========== DOM –≠–õ–ï–ú–ï–ù–¢–´ ==========
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        // –ü–æ–ª—É—á–∞–µ–º user_id –∏–∑ Telegram
        let userId = null;
        try {
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                userId = tg.initDataUnsafe.user.id;
                console.log('Telegram User ID:', userId);
            } else {
                console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å user_id –∏–∑ Telegram WebApp');
            }
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è user_id:', e);
        }

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadPrompt = document.getElementById('uploadPrompt');
        const imagePreview = document.getElementById('imagePreview');
        const previewImg = document.getElementById('previewImg');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const changeImageBtn = document.getElementById('changeImageBtn');
        const btnText = document.getElementById('btnText');
        const btnSpinner = document.getElementById('btnSpinner');
        const resultsSection = document.getElementById('resultsSection');
        const confidenceValue = document.getElementById('confidenceValue');
        const signalValue = document.getElementById('signalValue');
        const eventStats = document.getElementById('eventStats');
        const analyticsText = document.getElementById('analyticsText');
        const errorArea = document.getElementById('errorArea');
        const errorText = document.getElementById('errorText');
        const attemptsCounter = document.getElementById('attemptsCounter');
        const attemptsCounterMain = document.getElementById('attemptsCounterMain');
        const attemptsInfo = document.getElementById('attemptsInfo');

        let selectedFile = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –ø–æ–ø—ã—Ç–æ–∫ - —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ–º —Å —Å–µ—Ä–≤–µ—Ä–∞
        async function initAttempts() {
            attemptsCounter.textContent = '‚è≥';
            attemptsCounterMain.textContent = '‚è≥';
            
            try {
                const url = userId ? `/attempts?user_id=${userId}` : '/attempts';
                const response = await fetch(`${API_BASE}${url}`);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.success) {
                    updateAttemptsDisplay(data.attempts);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ø—ã—Ç–∫–∞—Ö:', error);
                
                setTimeout(() => {
                    initAttempts();
                }, 2000);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞
        function updateAttemptsDisplay(attemptsData) {
            const remaining = attemptsData.remaining;
            const total = attemptsData.total;
            const unlimited = attemptsData.unlimited || false;
            const t = translations[currentLang];
            
            // –ï—Å–ª–∏ –±–µ–∑–ª–∏–º–∏—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ë–µ–∑–ª–∏–º–∏—Ç"
            if (unlimited || remaining === -1) {
                const counterText = t.unlimited;
                attemptsCounter.textContent = counterText;
                attemptsCounterMain.textContent = counterText;
                
                // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –±–µ–∑–ª–∏–º–∏—Ç–∞
                attemptsCounter.classList.add('text-yellow-400');
                attemptsCounter.classList.remove('text-red-400', 'text-white');
                attemptsCounterMain.classList.add('text-yellow-400');
                attemptsCounterMain.classList.remove('text-red-400', 'text-emerald-400');
                
                return -1; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º -1 –¥–ª—è –±–µ–∑–ª–∏–º–∏—Ç–∞
            }
            
            const counterText = `${remaining} –∏–∑ ${total}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±–∞ —Å—á–µ—Ç—á–∏–∫–∞
            attemptsCounter.textContent = counterText;
            attemptsCounterMain.textContent = counterText;
            
            // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Å—Ç–∞—Ç–∫–∞
            if (remaining <= 2) {
                attemptsCounter.classList.add('text-red-400');
                attemptsCounter.classList.remove('text-yellow-400', 'text-white');
                attemptsCounterMain.classList.add('text-red-400');
                attemptsCounterMain.classList.remove('text-yellow-400', 'text-emerald-400');
            } else if (remaining <= 5) {
                attemptsCounter.classList.add('text-yellow-400');
                attemptsCounter.classList.remove('text-red-400', 'text-white');
                attemptsCounterMain.classList.add('text-yellow-400');
                attemptsCounterMain.classList.remove('text-red-400', 'text-emerald-400');
            } else {
                attemptsCounter.classList.add('text-white');
                attemptsCounter.classList.remove('text-red-400', 'text-yellow-400');
                attemptsCounterMain.classList.add('text-emerald-400');
                attemptsCounterMain.classList.remove('text-red-400', 'text-yellow-400');
            }
            
            return remaining;
        }

        // ========== –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ ==========
        const langSelector = document.getElementById('langSelector');
        const langModal = document.getElementById('langModal');
        const langList = document.getElementById('langList');
        const currentFlag = document.getElementById('currentFlag');
        const currentLangName = document.getElementById('currentLangName');

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ —è–∑—ã–∫–æ–≤
        function renderLanguages() {
            langList.innerHTML = languages.map(lang => `
                <div class="lang-item flex items-center gap-3 p-3 rounded-lg cursor-pointer hover:bg-slate-700 transition ${lang.code === currentLang ? 'bg-emerald-900 bg-opacity-30' : ''}" data-lang="${lang.code}">
                    <span style="font-size: 20px;">${lang.flag}</span>
                    <span class="text-white font-medium">${lang.name}</span>
                    ${lang.code === currentLang ? '<span class="ml-auto text-emerald-400">‚úì</span>' : ''}
                </div>
            `).join('');

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞
            document.querySelectorAll('.lang-item').forEach(item => {
                item.addEventListener('click', () => {
                    const newLang = item.dataset.lang;
                    if (newLang !== currentLang) {
                        currentLang = newLang;
                        localStorage.setItem('language', newLang);
                        updateLanguage();
                        renderLanguages();
                    }
                    langModal.classList.add('hidden');
                });
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateLanguage() {
            const lang = languages.find(l => l.code === currentLang);
            currentFlag.textContent = lang.flag;
            currentLangName.textContent = lang.name;
            updateTexts();
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
        langSelector.addEventListener('click', () => {
            langModal.classList.remove('hidden');
            renderLanguages();
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        langModal.addEventListener('click', (e) => {
            if (e.target === langModal) {
                langModal.classList.add('hidden');
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–∑—ã–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        updateLanguage();

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        const categorySelect = document.getElementById('categorySelect');
        categorySelect.addEventListener('change', (e) => {
            const body = document.body;
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Ç–µ–º—ã
            body.classList.remove('theme-ufc', 'theme-cs2', 'theme-dota', 'theme-hockey', 'theme-boxing', 'theme-basketball');
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω—É–∂–Ω—É—é —Ç–µ–º—É
            if (e.target.value !== 'football') {
                body.classList.add('theme-' + e.target.value);
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        initAttempts();

        // Click to upload
        uploadArea.addEventListener('click', () => {
            if (!selectedFile) {
                fileInput.click();
            }
        });

        // File input change
        fileInput.addEventListener('change', (e) => {
            handleFile(e.target.files[0]);
        });

        // Change image button
        changeImageBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            resetUI();
        });

        // Paste from clipboard
        document.addEventListener('paste', (e) => {
            const items = e.clipboardData?.items;
            if (items) {
                for (let item of items) {
                    if (item.type.startsWith('image/')) {
                        const file = item.getAsFile();
                        handleFile(file);
                        break;
                    }
                }
            }
        });

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        function resetUI() {
            selectedFile = null;
            fileInput.value = '';
            uploadPrompt.classList.remove('hidden');
            imagePreview.classList.add('hidden');
            analyzeBtn.classList.add('hidden');
            attemptsInfo.classList.add('hidden');  // –°–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
            resultsSection.classList.add('hidden');
            errorArea.classList.add('hidden');
        }

        // Handle file selection
        function handleFile(file) {
            const t = translations[currentLang];
            if (!file || !file.type.startsWith('image/')) {
                showError(t.errorImage);
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                showError(t.errorSize);
                return;
            }

            selectedFile = file;
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImg.src = e.target.result;
                uploadPrompt.classList.add('hidden');
                imagePreview.classList.remove('hidden');
                analyzeBtn.classList.remove('hidden');
                attemptsInfo.classList.remove('hidden');  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                resultsSection.classList.add('hidden');
                errorArea.classList.add('hidden');
            };
            reader.readAsDataURL(file);
        }

        // Analyze button click
        analyzeBtn.addEventListener('click', async () => {
            if (!selectedFile) return;

            const t = translations[currentLang];

            // Show loading state
            analyzeBtn.disabled = true;
            btnText.textContent = t.analyzing;
            btnSpinner.classList.remove('hidden');
            resultsSection.classList.add('hidden');
            errorArea.classList.add('hidden');

            const formData = new FormData();
            formData.append('image', selectedFile);
            if (userId) {
                formData.append('user_id', userId);
            }

            try {
                const response = await fetch(`${API_BASE}/analyze`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.status === 429) {
                    // –õ–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω
                    if (data.attempts) {
                        updateAttemptsDisplay(data.attempts);
                    }
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É —Ç–æ–ª—å–∫–æ —Å –∫–Ω–æ–ø–∫–æ–π, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –µ—ë –≤–µ—Ä–Ω—É–ª
                    showError(
                        data.error || '–í—ã –∏—Å—á–µ—Ä–ø–∞–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!',
                        data.purchase_url || null,
                        data.purchase_text || null
                    );
                    return;
                }

                if (data.success) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ —Å —Å–µ—Ä–≤–µ—Ä–∞
                    if (data.attempts) {
                        const remaining = updateAttemptsDisplay(data.attempts);
                        
                        // –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        if (remaining === 0) {
                            setTimeout(() => {
                                showError('–≠—Ç–æ –±—ã–ª–∞ –≤–∞—à–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!');
                            }, 1000);
                        }
                    }
                    
                    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    displayResults(data);
                    resultsSection.classList.remove('hidden');
                } else {
                    showError(data.error || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ');
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É: ' + error.message);
            } finally {
                analyzeBtn.disabled = false;
                btnText.textContent = t.analyzeBtn;
                btnSpinner.classList.add('hidden');
            }
        });

        function displayResults(data) {
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç AI
            const confidence = data.confidence || 70;
            const recommendedBet = data.recommended_bet || '–ê–Ω–∞–ª–∏–∑';
            const analysisText = data.analysis || data.description || '';
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å AI
            confidenceValue.textContent = confidence + '%';
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞–≤–∫—É
            signalValue.textContent = recommendedBet;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–æ–±—ã—Ç–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ AI
            const baseConfidence = confidence;
            const stats = [
                { label: recommendedBet, percent: baseConfidence }
            ];
            
            eventStats.innerHTML = stats.map(stat => `
                <div class="flex items-center justify-between">
                    <span class="text-gray-300 text-xs flex-1">${stat.label}</span>
                    <div class="flex items-center gap-2 flex-1">
                        <div class="progress-bar flex-1">
                            <div class="progress-fill" style="width: ${stat.percent}%"></div>
                        </div>
                        <span class="text-white text-xs font-bold w-8 text-right">${stat.percent}%</span>
                    </div>
                </div>
            `).join('');
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            let formatted = analysisText
                .replace(/\\n\\n/g, '<br><br>')  // –î–≤–æ–π–Ω—ã–µ –ø–µ—Ä–µ–Ω–æ—Å—ã
                .replace(/\\n/g, '<br>')          // –û–¥–∏–Ω–∞—Ä–Ω—ã–µ –ø–µ—Ä–µ–Ω–æ—Å—ã
                .replace(/\n\n/g, '<br><br>')     // –†–µ–∞–ª—å–Ω—ã–µ –¥–≤–æ–π–Ω—ã–µ –ø–µ—Ä–µ–Ω–æ—Å—ã
                .replace(/\n/g, '<br>')           // –†–µ–∞–ª—å–Ω—ã–µ –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –ø–µ—Ä–µ–Ω–æ—Å—ã
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');  // –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç
            
            analyticsText.innerHTML = formatted;
        }


        function showError(message, purchaseUrl = null, purchaseText = null) {
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            errorText.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            const messageDiv = document.createElement('div');
            messageDiv.textContent = message;
            messageDiv.className = 'mb-3';
            errorText.appendChild(messageDiv);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —è–≤–Ω–æ –≤–µ—Ä–Ω—É–ª –µ—ë
            if (purchaseUrl && purchaseText) {
                const purchaseBtn = document.createElement('a');
                purchaseBtn.href = purchaseUrl;
                purchaseBtn.target = '_blank';
                purchaseBtn.className = 'inline-block bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors mt-2';
                purchaseBtn.textContent = purchaseText;
                errorText.appendChild(purchaseBtn);
            }
            
            errorArea.classList.remove('hidden');
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏
            if (!purchaseUrl) {
                setTimeout(() => {
                    errorArea.classList.add('hidden');
                }, 5000);
            }
        }
    </script>
</body>
</html>